<!DOCTYPE html>
<html>
<head>
    <title>SEPD</title>
    <link href="css/bootstrap.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <script src="lib/jquery-3.3.1.min.js"></script>
    <script src="lib/scripts.js"></script>
	<link rel="icon" href="imagens/SEPD.png" type="image/x-icon">
    <style>
        /* Estilo personalizado para garantir responsividade em uma televisão */
        body {
            background-color: #0761AC;
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            overflow: hidden;
        }

        .container {
            max-width: 100vw;
            padding: 0 2vw;
        }

        .barraSuperior {
            height: 10%;
            display: flex;
            align-items: center;
            margin-top: 3%;
        }

        .uespiLogo {
            max-width: 100%;
        }

        .uespiTexto {
            font-size: 3.5vw;
            font-weight: 800;
            color: #DAE908;
            margin: 0;
            text-align: center;
            flex-grow: 1;
        }

        .row {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 1%;
        }

        .senhaAtual {
            background-color: #0761AC;
            color: #FFFFFF;
            padding: 2% 0;
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .senhaGuicheContainer {
            display: flex;
            justify-content: space-around;
            align-items: center;
            width: 100%;
        }

        .senhaAtualTexto, .guicheTexto {
            font-size: 5vw;
            font-weight: 600;
            color: #FFFFFF;
            margin: 0;
        }

        #senhaAtualNumero {
            font-size: 8vw;
            font-weight: 600;
            color: #DAE908;
            margin-left: 1vw;
        }

        #guicheNumero {
            font-size: 8vw;
            font-weight: 700;
            color: #DAE908;
        }

        .ultimaSenha {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        #ultimaSenhaTexto {
            font-size: 4vw;
            color: #DAE908;
            margin-bottom: 0%;
        }

        #senhaDescricao {
            font-size: 5vw;
            color: #ffff;
            margin-top: 0%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #ultimaSenhaNumero {
            font-size: 7vw;
            color: #DAE908;
            margin-top: 0%;
        }
    </style>
</head>
<body>
    <div class="container page">
        <div class="row barraSuperior">
            <div class="col-xs-2">
                <img src="imagens/SEPD.png" class="uespiLogo">
            </div>
            <div class="col-xs-10">
                <span class="uespiTexto">CONTROLE DE SENHA CAD PCD - GAMA</span>
            </div>
        </div>
        <div class="row senhaAtual">
            <div class="senhaGuicheContainer">
                <div>
                    <div class="guicheTexto">GUICHÊ</div>
                    <span id="guicheNumero">01</span>
                </div>
                <div>
                    <div class="senhaAtualTexto">SENHA</div>
                    <span id="senhaAtualNumero">0000</span>
                </div>
            </div>
        </div>
        <div class="row ultimaSenha">
            <span id="ultimaSenhaTexto">ÚLTIMA SENHA CHAMADA</span><br>
            <div id="senhaDescricao">
                Senha:    
                <span id="ultimaSenhaNumero">0000</span>
            </div>
        </div>
    </div>
    <audio id="audioChamada" src="audio/chamada.wav"></audio>

    <script>
        // Inicializar valores
        let senhaAtual = null;
        let ultimaSenha = 0;

        // Mapear senhas para guichês
        const guiches = {
            1: "01",
            2: "02",
            3: "03",
            4: "04",
            5: "05",
            6: "06"
        };

        // Mapear status dos guichês (ocupado ou liberado)
        let guichesStatus = {
            1: "liberado",
            2: "liberado",
            3: "ocupado",
            4: "liberado",
            5: "liberado",
            6: "liberado"
        };

        // Função para atualizar o display da senha e guichê
        function atualizarDisplay() {
            document.getElementById('senhaAtualNumero').textContent = senhaAtual !== null ? senhaAtual.toString().padStart(4, '0') : '0000';
            document.getElementById('ultimaSenhaNumero').textContent = ultimaSenha.toString().padStart(4, '0');
            const guiche = document.getElementById('guicheNumero').textContent;
            document.getElementById('guicheNumero').textContent = guiche;
        }

        // Função para selecionar o próximo guichê liberado
        function selecionarGuicheLiberado() {
            for (const guiche in guichesStatus) {
                if (guichesStatus[guiche] === "liberado") {
                    return guiche;
                }
            }
            return "N/A";
        }

        // Função para incrementar a senha
        function incrementarSenha() {
            if (senhaAtual === null) {
                senhaAtual = 1;
            } else {
                ultimaSenha = senhaAtual;
                senhaAtual++;
            }

            const guicheAtual = Math.ceil(senhaAtual / 10);
            if (guichesStatus[guicheAtual] === "ocupado") {
                const guicheLiberado = selecionarGuicheLiberado();
                if (guicheLiberado !== "N/A") {
                    guichesStatus[guicheLiberado] = "ocupado";
                    guichesStatus[guicheAtual] = "liberado";
                    document.getElementById('guicheNumero').textContent = guiches[guicheLiberado];
                } else {
                    alert('Nenhum guichê liberado disponível.');
                    return;
                }
            } else {
                guichesStatus[guicheAtual] = "ocupado";
                document.getElementById('guicheNumero').textContent = guiches[guicheAtual];
            }

            atualizarDisplay();
            document.getElementById('audioChamada').play();
        }

        // Função para resetar senhas
        function resetarSenhas() {
            senhaAtual = null;
            ultimaSenha = 0;
            atualizarDisplay();
        }

        // Adicionar evento para as teclas de atalho
        document.addEventListener('keydown', function(event) {
            if (event.key === 'ArrowRight') {
                incrementarSenha();
            } else if (event.key === 'r') {
                resetarSenhas();
            } else if (event.key === 'g') {
                const guiche = prompt("Digite o número do guichê (1-6):");
                if (guiches[guiche]) {
                    document.getElementById('guicheNumero').textContent = guiches[guiche];
                    incrementarSenha();
                } else {
                    alert("Guichê inválido.");
                }
            }
        });
    </script>
</body>
</html>
